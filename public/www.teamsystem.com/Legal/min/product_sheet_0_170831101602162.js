function setCart(n){n.d.Status?($(".mainCart .num_items").html("("+n.d.Props.Count+")"),$("#miniCart").html(n.d.HTML)):alert(n.d.ErrMessage)}function loadCart(){$.ajax({type:"POST",url:"/ws/wsECommerce.asmx/MiniCart",cache:!1,contentType:"application/json; charset=utf-8",data:'{"w":"s"}',dataType:"json",success:setCart})}function AddProduct(n){$.ajax({type:"POST",url:"/WS/wsEcommerce.asmx/bAdd",cache:!1,contentType:"application/json; charset=utf-8",data:JSON2.stringify({id:n,qta:1}),dataType:"json",success:function(n){n!=null&&(setCart(n),$("html, body").animate({scrollTop:0},500),$(".box_shopping").slideDown(1e3),$("li.openMiniCart").addClass("active"),setTimeout(function(){$("#miniCart").fadeOut(1e3,function(){$("li.openMiniCart").removeClass("active")})},2e3))},error:function(){alert("Web-Service Error!!")}})}function RemoveProduct(n){$.ajax({type:"POST",url:"/ws/wsECommerce.asmx/bRemove",cache:!1,contentType:"application/json; charset=utf-8",data:JSON2.stringify({hashcode:n}),dataType:"json",success:function(t){t.d.Status&&(_bind($(document),t.d.Props),loadCart(),$("#basket"+n).remove())},error:wsError})}function changeQta(n,t){var r=$("#basket"+n),u=r.find(".currQtaInput"),i=r.find(".qtaInput"),f=Number(u.val());if(to=Number(i.val()),t=="blur"&&i.val()==""){i.val(u.val());i.removeAttr("style");return}if(i.removeAttr("style"),isNaN(to)||to<=0){i.attr("style","color:#f00;");return}f!=to&&$.ajax({type:"POST",url:"/ws/wsECommerce.asmx/bChangeQta",cache:!1,contentType:"application/json; charset=utf-8",data:JSON2.stringify({hashcode:n,qta:to}),dataType:"json",success:function(n){n.d.Status&&(_bind(r,n.d.Props),loadCart())},error:wsError})}function RetrieveSpeseSped(){var n=$(this).val();return $.ajax({type:"POST",url:"/ws/wsECommerce.asmx/bSpeseSped",cache:!1,contentType:"application/json; charset=utf-8",data:JSON2.stringify({id:n}),dataType:"json",success:function(n){n.d.Status&&_bind($(document),n.d.Props)},error:wsError}),!0}function CheckBasket(){var i=$("#ddlPaesiSped").val(),t,n;return i==-1?(n="<div class='alertFancy'>"+$("#alertPaeseSpedReq").html()+"<\/div>",$.fancybox({content:n}),!1):(t=$(".lista").size(),t<=0)?(n="<div class='alertFancy'>"+$("#alertBasketEmpty").html()+"<\/div>",$.fancybox({content:n}),!1):!0}function wsError(n,t,i){var r=t;i!=null&&i!=""&&(r=t+" ("+i+")");Log("  "+r);alert(r);removeLoading()}function _bind(n,t){var i,r;for(name in t)i=name.match(/(\S*) (val|text|html)$/),i&&(r=n.find(i[1]),r.size()==0&&(r=$(i[1])),$.fn[i[2]].call(r,t[name]))}$(function(){$("#orderCountrySelect").change(RetrieveSpeseSped);$(".iFrameCodSconto").size()>0&&$(".iFrameCodSconto").fancybox({titleShow:!1,width:650,height:350})})